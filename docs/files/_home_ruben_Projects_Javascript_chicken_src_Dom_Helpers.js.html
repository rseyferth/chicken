<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>/home/ruben/Projects/Javascript/chicken/src/Dom/Helpers.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Api.Api.html">Api.Api</a></li>
            
                <li><a href="../classes/Api.ApiCall.html">Api.ApiCall</a></li>
            
                <li><a href="../classes/Api.JsonApi.html">Api.JsonApi</a></li>
            
                <li><a href="../classes/Api.JsonApiCall.html">Api.JsonApiCall</a></li>
            
                <li><a href="../classes/Application.html">Application</a></li>
            
                <li><a href="../classes/Auth.Auth.html">Auth.Auth</a></li>
            
                <li><a href="../classes/Auth.JWTAuth.html">Auth.JWTAuth</a></li>
            
                <li><a href="../classes/Core.ComputedProperty.html">Core.ComputedProperty</a></li>
            
                <li><a href="../classes/Core.Obj.html">Core.Obj</a></li>
            
                <li><a href="../classes/Core.Observable.html">Core.Observable</a></li>
            
                <li><a href="../classes/Core.ObservableArray.html">Core.ObservableArray</a></li>
            
                <li><a href="../classes/Core.SettingsObject.html">Core.SettingsObject</a></li>
            
                <li><a href="../classes/Data.Model.html">Data.Model</a></li>
            
                <li><a href="../classes/Dom.ActionBinding.html">Dom.ActionBinding</a></li>
            
                <li><a href="../classes/Dom.Binding.html">Dom.Binding</a></li>
            
                <li><a href="../classes/Dom.Component.html">Dom.Component</a></li>
            
                <li><a href="../classes/Dom.Element.html">Dom.Element</a></li>
            
                <li><a href="../classes/Dom.Helpers.html">Dom.Helpers</a></li>
            
                <li><a href="../classes/Dom.Renderer.html">Dom.Renderer</a></li>
            
                <li><a href="../classes/Dom.View.html">Dom.View</a></li>
            
                <li><a href="../classes/Dom.ViewContainer.html">Dom.ViewContainer</a></li>
            
                <li><a href="../classes/Helpers.Utils.html">Helpers.Utils</a></li>
            
                <li><a href="../classes/Routing.Action.html">Routing.Action</a></li>
            
                <li><a href="../classes/Routing.Controller.html">Routing.Controller</a></li>
            
                <li><a href="../classes/Routing.Request.html">Routing.Request</a></li>
            
                <li><a href="../classes/Routing.Route.html">Routing.Route</a></li>
            
                <li><a href="../classes/Routing.RouteMatch.html">Routing.RouteMatch</a></li>
            
                <li><a href="../classes/Routing.Router.html">Routing.Router</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Api.html">Api</a></li>
            
                <li><a href="../modules/Auth.html">Auth</a></li>
            
                <li><a href="../modules/AuthError.html">AuthError</a></li>
            
                <li><a href="../modules/Core.html">Core</a></li>
            
                <li><a href="../modules/Data.html">Data</a></li>
            
                <li><a href="../modules/Dom.html">Dom</a></li>
            
                <li><a href="../modules/Helpers.html">Helpers</a></li>
            
                <li><a href="../modules/Localization.html">Localization</a></li>
            
                <li><a href="../modules/Routing.html">Routing</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: /home/ruben/Projects/Javascript/chicken/src/Dom/Helpers.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/* eslint no-console: [&quot;error&quot;, { allow: [&quot;log&quot;] }] */

import _ from &#x27;underscore&#x27;;
import $ from &#x27;jquery&#x27;;
import QueryString from &#x27;query-string&#x27;;
import inflection from &#x27;inflection&#x27;;
import moment from &#x27;moment&#x27;;

import ActionBinding from &#x27;~/Dom/ActionBinding&#x27;;
import Utils from &#x27;~/Helpers/Utils&#x27;;
import App from &#x27;~/Helpers/App&#x27;;
import Observable from &#x27;~/Core/Observable&#x27;;
import ObservableArray from &#x27;~/Core/ObservableArray&#x27;;

/**
 * @module Dom
 */
class Helpers
{

	/**
	 * @class Dom.Helpers
	 *
	 * @constructor 
	 * @param  {Dom.Renderer} renderer
	 */
	constructor(renderer) {
		this.renderer = renderer;
	}


	/////////////
	// Actions //
	/////////////

	action(params, attributeHash, blocks /*, morph, renderer, scope, visitor*/) {
		
		// There should be an ActionBinding for this element
		let element = blocks.element;
		if (element &amp;&amp; element.getAttribute(&#x27;data-chicken-action&#x27;)) {
			
			// Get the action
			var binding = ActionBinding.get(element.getAttribute(&#x27;data-chicken-action&#x27;));
			binding.apply();

		} else {
			throw new Error(&#x27;The &quot;action&quot; keyword was not correctly configured in your Renderer... Or you are trying to add an action to a Component.&#x27;);
		}

	}


	/////////////
	// Routing //
	/////////////

	link(params, attributeHash, blocks /*, morph, renderer, scope, visitor*/) {
	
		// Add listener
		if (blocks.element) {

			// Add click listener
			let $el = $(blocks.element);
			$el.each((index, el) =&gt; {

				// Set href for easy debuggin&#x27; and statusbar info
				$(el).attr(&#x27;href&#x27;, this._getValue(params[0]));

			}).on(&#x27;click&#x27;, (e) =&gt; {
				e.preventDefault();

				// Get uri value
				let uri = this._getValue(params[0]);

				// Go there.
				App().goto(uri);

			});
			
			
		}
	}


	////////////////////////
	// Control statements //
	////////////////////////


	/**
	 * @method each
	 */
	each(params, attributeHash, blocks, morph /*, renderer, scope, visitor*/) {

		// Check uid for this each-block
		var eachUid = Utils.uidFor(morph);
		
		// Get the value
		let list = this._getValue(params[0]);
		Utils.each(list, (item, i) =&gt; {

			// Get a unique id for the item.
			let uid = Utils.uidFor(item);
			let itemKey = &#x27;each:&#x27; + eachUid + &#x27;:&#x27; + i + &#x27;:&#x27; + uid;
			
			// Render item
			blocks.template.yieldItem(itemKey, [item, i]);

		});
		
	}

	/**
	 * @method if	 
	 */
	if(params, attributeHash, blocks /*, morph, renderer, scope, visitor*/) {

		// Get the value
		let value = this._getValue(params[0]);
		return this._ifUnless(params, blocks, Utils.isTruthlike(value));		

	}

	/**
	 * @method unless
	 */
	unless(params, attributeHash, blocks /*, morph, renderer, scope, visitor*/) {

		// Get the value
		let value = this._getValue(params[0]);
		return this._ifUnless(params, blocks, !Utils.isTruthlike(value));

	}

	_ifUnless(params, blocks, show) {

		// Is the param truth-like?
		if (show) {

			// Is it a yielding-if?
			if (blocks.template &amp;&amp; blocks.template.yield) {
				blocks.template.yield();

			// Or parameter-if?
			} else {

				return this._getValue(params[1]);
				
			}

		} else {

			// Render the inverse yield
			if (blocks.inverse &amp;&amp; blocks.inverse.yield) {
				blocks.inverse.yield();
			
			// Or the inverse param
			} else {
				return this._getValue(params[2]);
			}
		}

	}


	////////////
	// Values //
	////////////

	concat(params, attributeHash/*, blocks, morph, renderer, scope, visitor*/) {

		attributeHash = _.defaults(attributeHash, {
			separator: &#x27;&#x27;
		});
		return this._getValues(params).join(attributeHash.separator);

	}

	get(params) {

		// Get params
		let obj = this._getValue(params[0]);
		let key = this._getValue(params[1]);

		// Is it an observable?
		if (obj instanceof Observable || obj instanceof ObservableArray) {
			return obj.get(key);
		} else {
			return obj[key];
		}

	}

	firstIn(params) {

		let arr = this._getValue(params[0]);
		if (arr instanceof ObservableArray) {
			return arr.first();
		} else {
			return _.first(arr);
		}

	}

	equal(params) {

		// Get params
		let value1 = this._getValue(params[0]);
		let value2 = this._getValue(params[1]);
		return value1 == value2;

	}
	notEqual(params) {
		return !this.equal(params);
	}

	gt(params) {

		// Get params
		let value1 = this._getValue(params[0]);
		let value2 = this._getValue(params[1]);
		return value1 &gt; value2;

	}
	gte(params) {

		// Get params
		let value1 = this._getValue(params[0]);
		let value2 = this._getValue(params[1]);
		return value1 &gt;= value2;

	}
	lt(params) {

		// Get params
		let value1 = this._getValue(params[0]);
		let value2 = this._getValue(params[1]);
		return value1 &lt; value2;

	}
	lte(params) {

		// Get params
		let value1 = this._getValue(params[0]);
		let value2 = this._getValue(params[1]);
		return value1 &lt;= value2;

	}

	isObject(params) {
		// Get param
		let value = this._getValue(params[0]);
		return value instanceof Object;

	}


	//////////////////
	// HTML Helpers //
	//////////////////

	attributesFrom(params, attributeHash, blocks, morph) {

		console.log(params, attributeHash, blocks, morph);

	}


	/////////////
	// Strings //
	/////////////

	camelize(params) {

		let string = this._getValue(params[0]);
		let capitalFirstLetter = !!this._getValue(params[1]);

		return inflection.camelize(string, !capitalFirstLetter);

	}


	/////////////////////
	// Dates and times //
	/////////////////////

	momentFormat(params) {
		let value = this._getValue(params[0]);
		let format = this._getValue(params[1]);
		if (moment.isMoment(value)){ 
			return value.format(format);
		} else {
			return value;
		}
	}



	///////////
	// Debug //
	///////////

	log(params/*, attributeHash, blocks, morph, renderer, scope, visitor*/) {
		console.log.apply(console, this._getValues(params));
	}

	&#x27;query-params&#x27;(params, attributeHash /*, blocks, morph, renderer, scope, visitor*/) {
		return QueryString.stringify(this._getHashValues(attributeHash));		
	}



	//////////////////
	// Localization //
	//////////////////

	t(params, attributeHash) {

		// Get the key
		let key = this._getValue(params[0]);

		// Get from app
		return App().i18n.translate(key, attributeHash);

	}



	//////////////
	// Internal //
	//////////////

	_getValue(param) {
		return this.renderer.hooks.getValue(param);
	}

	_getValues(params) {
		return params.map((value) =&gt; {
			return this._getValue(value);
		});
	}
	_getHashValues(attributeHash) {
		var result = {};
		_.each(attributeHash, (value, key) =&gt; {
			result[key] = this._getValue(value);
		});
		return result;
	}

	

}

module.exports = Helpers;
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
